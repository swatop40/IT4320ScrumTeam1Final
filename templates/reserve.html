{% extends "base.html" %}

{% block content %}
<div class="container" style="margin-top: 40px;">
  <div class="box" style="max-width: 800px; margin: auto; padding: 30px;">

    <h1 class="title has-text-centered">Reserve a Seat</h1>

    <form method="POST">
      <div class="columns">
        <div class="column">
          <div class="field">
            <label class="label">First Name</label>
            <div class="control">
              <input class="input" name="first_name" required>
            </div>
          </div>
        </div>

        <div class="column">
          <div class="field">
            <label class="label">Last Name</label>
            <div class="control">
              <input class="input" name="last_name" required>
            </div>
          </div>
        </div>
      </div>

      <div class="columns">
        <div class="column">
          <div class="field">
            <label class="label">Row (1-12)</label>
            <div class="control">
              <input class="input" name="seat_row" type="number" min="1" max="12" required>
            </div>
          </div>
        </div>

        <div class="column">
          <div class="field">
            <label class="label">Column (1-4)</label>
            <div class="control">
              <input class="input" name="seat_col" type="number" min="1" max="4" required>
            </div>
          </div>
        </div>
      </div>

      <div class="field has-text-centered">
        <button class="button is-primary is-medium" type="submit">
          Reserve Seat
        </button>
      </div>
    </form>

    <hr>

    <h2 class="subtitle has-text-centered">Current Seating</h2>

    <div class="table-container">
      <table class="table is-bordered is-striped is-fullwidth">
        <thead>
          <tr>
            <th>Row</th>
            {% for c in range(1, cols + 1) %}
              <th>C{{ c }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
        {% for r in range(0, rows) %}
          <tr>
            <td><strong>{{ r + 1 }}</strong></td>
            {% for c in range(0, cols) %}
              {% set seat = chart[r][c] %}
              <td class="{{ 'has-background-danger-light' if seat.reserved else 'has-background-success-light' }}">
                {% if seat.reserved %}
                  <strong>{{ seat.name }}</strong><br>
                  <small>Occupied</small>
                {% else %}
                  Available<br>
                  <small>${{ "%.2f"|format(cost_matrix[r][c]) }}</small>
                {% endif %}
              </td>
            {% endfor %}
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</div>
{% endblock %}
